# Elastic Load Balancer - 고가용성을 위한 로드밸런싱

![구성도](../../img/ELB%20다이어그램.png)


부하분산 - 로드밸런싱, 오토스케일링, 캐싱

서버가 프라이빗 서브넷으로 이전되면서 외부에서 API 요청을 받을 수 없게 됨.

뿐만 아니라 다른 특징과 기능도 있음.

고가용성, 확장성, 보안강화, 장애조치

### 로드밸런싱

- 트래픽 제어하여 서버에 균등하게 배포하는 방법을 로드밸런싱
- 이런 역할을 하는 서비스를 로드밸런서
- AWS에서 제공하는 로드밸런서 Elastic Load Balancer

### Elastic Load Balancer

- AWS 완전 관리 서비스
- 다른 AWS 서비스와 쉬운 통합
- ELB와 EC2를 통합하면 고가용성, 확장성 등 장점

### ELB 특징

확장성(Scalability)

- 트래픽을 처리할 수 있는 성능이나 양을 키우는 것
- 수직확장과 수평확장
- AWS 서비스를 이용하면 자동으로 확장하기 쉽다.

보안강화

<img src="../../img/로드밸런싱 보안강화.png" width="300" height="300"> 


- 로드밸런서가 없이 여러 인스턴스로 분배하게 되면,
- 트패픽은 여러 엔드포인트로 나눠지게 되는데,
- 이때 SSL 인증서를 적용하려면 나눠지는 엔드프인트 개수만큼 작업이 늘어날 수 있다.
- 로드밸런서를 사용하게 되면 여러 개의 인스턴스를 하난의 로드밸런서 엔드포인트로 외부에서 접근할 수 있게 된다.
- SSL 보안 설정도 하나의 엔드포인트에 대해 적용해주면 되기 때문에 확장이 일어나도 추가적인 작업이 필요없다.

장애조치

<div style="display: flex;">
  <img src="../../img/로드밸런싱 장애조치.png" width="300" height="300" alt="로드밸런싱 장애조치1">
  <img src="../../img/로드밸런싱 장애조치2.png" width="300" height="300" alt="로드밸런싱 장애조치2">
</div>
<br>

- 로드밸런서는 타겟으로 등록되어 있는 인스턴스의 상태를 주기적으로 확인한다.
- 설정해 놓은 정산 응답이 아닐 경우 해당 인스턴스는 로드밸런싱 대상에서 제외되고,
- 정상적인 응답이 오는 인스턴스로만 트래픽을 보내서 장애조치를 하게 된다.
- 이런 특징은 시스템의 고가용성을 유지할 수 있게 해준다.

수직확장

- Scale Up, Vertical Scaling
- 인스턴스 자체의 스펙을 키우는 것
- 뎅데이터베이스 같이 분산하기 힘든 시스템에 주로 사용
- 다시 줄이는 것은 Scale Down

수평확장

- Scale Out, Horizon Scaling
- AWS에서 탄력성이라고 부름
- 인스턴스의 개수를 늘리는 것
- 일반적으로 EC2같은 서버는 수평확장을 사용
- 다시 줄이는 것을 Scale In

수직확장 VS 수평확장

- 더 쉬운 방법은 수직 확장
- 수직 확장은 확장에 제한
- 확장 시 다운 타임이 있을 수 있음
- 하나의 가용영역을 사용하게 되면 가용성에 문제
- 이러한 문제들과 고가용성 서비스를 위해 수평확장을 지향

### 고가용성

- 일반적으로 수평확장과 같이 사용되는 개념
- 서비스가 오랜 기간 동안 지속적으로 정상 운영이 가능한 성질
- AWS에서 고가용성은 인스턴스나 시스템이 여러 가용영역에 가동중인 것을 의미

고가용성 다이어그램

<img src="../../img/고가용성 다이어그램.png" width="300" height="300"> 


### ELB 종류

- Classic Load Balancer
    - 2009년 출시
    - HTTP, HTTPS, TCP등 여러 프로토콜 지원
    - AWS에서 사용을 권장하지 않음
- Network Load Balancer
    - 2017년 출시
    - TCP, UDP 등 프로토콜 지원
    - 높은 처리량이 필요한 네트워크 애플리케이션이나 게임 서버에 사용
- Application Load Balancer
    - 2016년 출시
    - HTTP, HTTPS, WebSocket 프로토콜 지원
    - 웹 애플리케이션 라우팅에 주로 사용
- Gateway Load Balancer
    - 2020년 출시
    - TCP, UDP, HTTP, HTTPS등 여러 프로토콜 지원
    - VPC 간의 라우팅, VPC 연결 등에 사용

<br>

<img src="../../img/로드밸런서 유형.png" width="300" height="300"> 
